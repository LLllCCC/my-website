<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åšå®¢ - Yopo</title>
    <link rel="icon" href="assets/my-avatar.jpg" type="image/jpeg">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <script src="theme-init.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="global-nav"></div>

    <div class="container blog-container">
        
        <div class="blog-header fade-in">
            <h1>æ€ç»´ç¢ç‰‡</h1>
            <p>è®°å½•ä»£ç æ—…ç¨‹ä¸ç”Ÿæ´»ç‚¹æ»´ã€‚</p>
        </div>

        <div class="article-list" id="dynamic-article-list">
            <p style="text-align: center; color: var(--text-secondary); grid-column: 1/-1;">æ­£åœ¨ä»æ•°æ®åº“åŠ è½½æ–‡ç« ... ğŸš€</p>
        </div>

        <div id="global-footer"></div>
        <script src="/footer.js"></script>
    </div>

    <script src="/nav.js"></script>
    <script src="main.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", async function() {
            const listContainer = document.getElementById("dynamic-article-list");
            const API_URL = "https://yopoo.888431.xyz/api/posts";

            try {
                // 1. è·å–æ•°æ®
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error("API å“åº”å¤±è´¥");
                const posts = await response.json();

                // 2. æ¸…ç©ºâ€œåŠ è½½ä¸­â€æç¤º
                listContainer.innerHTML = "";

                // 3. æ’åºï¼šæŒ‰æ—¥æœŸé™åºæ’åˆ—
                posts.sort((a, b) => new Date(b.date) - new Date(a.date));

                // 4. å¾ªç¯ç”Ÿæˆå¡ç‰‡
                posts.forEach(post => {
                    const card = document.createElement("div");
                    card.className = "card blog-post-card fade-in";
                    
                    // è®¾ç½®èƒŒæ™¯å›¾
                    if (post.cover) {
                        card.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.7)), url('${post.cover}')`;
                    }

                    // å¡«å……å¡ç‰‡å†…å®¹
                    card.innerHTML = `
                        <div class="card-content">
                            <div class="post-meta">
                                <span class="post-date">${post.date}</span>
                                <span class="post-tag">${post.tags || 'ç”Ÿæ´»'}</span>
                            </div>
                            <h2 class="post-title">${post.title}</h2>
                            <p class="post-desc">${post.description || ''}</p>
                            <a href="${post.link}" class="read-more">é˜…è¯»å…¨æ–‡ <i class="ri-arrow-right-line"></i></a>
                        </div>
                    `;
                    
                    listContainer.appendChild(card);
                });

                console.log("âœ… åšå®¢åˆ—è¡¨é¡µå·²æˆåŠŸåŠ¨æ€æ¸²æŸ“ " + posts.length + " ç¯‡æ–‡ç« ");

            } catch (error) {
                console.error("âŒ æ¸²æŸ“åšå®¢åˆ—è¡¨å‡ºé”™:", error);
                listContainer.innerHTML = `<p style="text-align: center; color: #ff4d4d; grid-column: 1/-1;">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯ API æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p>`;
            }
        });
    </script>
</body>
</html>