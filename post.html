<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ­£åœ¨åŠ è½½æ–‡ç« ...</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
      .post-content {
        max-width: 800px;
        margin: 40px auto;
        padding: 20px;
        line-height: 1.8;
      }
      /* ç»™ Markdown è½¬æ¢å‡ºæ¥çš„ä»£ç å—åŠ ç‚¹æ ·å¼ */
      pre {
        background: #f4f4f4;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
      }
      code {
        font-family: "Courier New", Courier, monospace;
        color: #d63384;
      }
    </style>
  </head>
  <body>
    <div id="global-nav"></div>

    <article class="container">
      <div class="blog-header">
        <h1 id="article-title">åŠ è½½ä¸­...</h1>
        <p id="article-meta" style="color: var(--text-secondary)"></p>
      </div>

      <div id="article-body" class="post-content"></div>
    </article>

    <script src="/nav.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // 3. ä»ç½‘é¡µé“¾æ¥é‡Œè·å–æ–‡ç«  ID (ä¾‹å¦‚ post.html?id=5)
        const urlParams = new URLSearchParams(window.location.search);
        const postId = urlParams.get("id");

        if (!postId) {
          document.getElementById("article-body").innerHTML =
            "æ–‡ç«  ID ä¸¢å¤±å•¦ï¼ğŸ‘€";
          return;
        }

        try {
          // 4. å»åç«¯è¯·æ±‚è¿™ç¯‡æ–‡ç« çš„è¯¦æƒ… (åŒ…å« content å­—æ®µ)
          const res = await fetch(
            `https://yopoo.888431.xyz/api/posts/${postId}`,
          );
          const post = await res.json();

          // 5. æ›´æ–°æ ‡é¢˜å’Œå…ƒæ•°æ®
          document.title = post.title;
          document.getElementById("article-title").textContent = post.title;
          document.getElementById("article-meta").textContent =
            `${post.date} Â· ${post.tags}`;

          // 6. ğŸ”¥ æ ¸å¿ƒé­”æ³•ï¼šå°†æ•°æ®åº“é‡Œçš„å†…å®¹ä¼ ç»™ marked è½¬æ¢æˆ HTML
          // å¦‚æœæ•°æ®åº“é‡Œçš„ content æ˜¯ç©ºçš„ï¼Œå°±æ˜¾ç¤ºæç¤ºæ–‡å­—
          const markdownRaw = post.content || "è¿™ç¯‡æ–‡ç« è¿˜æ²¡æœ‰æ­£æ–‡å†…å®¹å“¦ã€‚";
          document.getElementById("article-body").innerHTML =
            marked.parse(markdownRaw);
        } catch (err) {
          console.error(err);
          document.getElementById("article-body").innerHTML =
            "åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API æ˜¯å¦å¼€å¯ã€‚";
        }
      });
    </script>
  </body>
</html>
